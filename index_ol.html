	<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="../../assets/ico/favicon.png">

    <title>Terrain</title>

    <!-- Bootstrap core CSS -->
    <link href="scripts/lib/leaflet/dist/leaflet.css" rel="stylesheet">
    <link href="scripts/lib/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/terr.css" rel="stylesheet">
	<link href="scripts/lib/leaflet-draw/dist/leaflet.draw.css" rel="stylesheet" />
	<link href="scripts/lib/ol3/v3.3.0/css/ol.css" rel="stylesheet" />
	
</head>
  
<body>
  
    <script src="scripts/lib/jquery/dist/jquery.min.js"></script>
    <script src="scripts/lib/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="scripts/lib/leaflet/dist/leaflet.js"></script>
	<script src="scripts/lib/leaflet-draw/dist/leaflet.draw.js"></script>
    <script src="scripts/dist/cloudy.js"></script>
    <script src="scripts/lib/ol3/v3.3.0/build/ol.js"></script>
    <script src="scripts/lib/ol3/v3.3.0/resources/example-behaviour.js"></script>

        <div id="topright">
        </div>
        <div id="map"></div>
        <div id="sidebar"></div>
   
    </div>
   
	<script>
	
    
        

    var projection = new ol.proj.Projection({
      code: 'EPSG:25833',
      // The extent is used to determine zoom level 0. Recommended values for a
      // projection's validity extent can be found at http://epsg.io/.
      extent: [-150000, 5027916,4640000, 9051551],
      units: 'm'
    });
    ol.proj.addProjection(projection);
    
    
    var map = new ol.Map({
            
        layers: [new ol.layer.Tile({
            source: new ol.source.TileWMS(/** @type {olx.source.TileWMSOptions} */ ({
              url:  "https://www.webatlas.no/wms-std-demo/",    
              params: {'LAYERS': 'Kart', 'TILED': true},
              extent: [-150000, 5027916,4640000, 9051551],
              serverType: 'geoserver'
            }))
          })
        ],
        controls: ol.control.defaults({
        attributionOptions: /** @type {olx.control.AttributionOptions} */ ({
            collapsible: false
        })
        }),
        
        renderer: exampleNS.getRendererFromQueryString(),
        target: 'map',
        view: new ol.View({
            projection: 'EPSG:3857',
            center: [0, 0],
            zoom: 2
        })
    });
    
    
    var vectorLayer = new ol.layer.Vector({
      source: new ol.source.GeoJSON({
        projection: 'EPSG:3857',
        url: 'http://10.0.0.249/datapi/rasters/rastergrid'
      }),
      style: function(feature, resolution) {
        style.getText().setText(resolution < 5000 ? feature.get('name') : '');
        return styles;
      }
    });
        
    
        
        
    // The features are not added to a regular vector layer/source,
    // but to a feature overlay which holds a collection of features.
    // This collection is passed to the modify and also the draw
    // interaction, so that both can add or modify features.
    var featureOverlay = new ol.FeatureOverlay({
      style: new ol.style.Style({
        fill: new ol.style.Fill({
          color: 'rgba(255, 255, 255, 0.2)'
        }),
        stroke: new ol.style.Stroke({
          color: '#ffcc33',
          width: 2
        }),
        image: new ol.style.Circle({
          radius: 7,
          fill: new ol.style.Fill({
            color: '#ffcc33'
          })
        })
      })
    });
    featureOverlay.setMap(map);

    var modify = new ol.interaction.Modify({
      features: featureOverlay.getFeatures(),
      // the SHIFT key must be pressed to delete vertices, so
      // that new vertices can be drawn at the same position
      // of existing vertices
      deleteCondition: function(event) {
        return ol.events.condition.shiftKeyOnly(event) &&
            ol.events.condition.singleClick(event);
      }
    });
    map.addInteraction(modify);

    var draw; // global so we can remove it later
    function addInteraction() {
      draw = new ol.interaction.Draw({
        features: featureOverlay.getFeatures(),
        type: "Polygon"
      });
      map.addInteraction(draw);
    
    }
    addInteraction();
    
    
    
    
    
	var geojson;
    $.getJSON('/datapi/rasters/rastergrid', function (data) {
        for (i=0; i<data.length; i++) {
            geojson.addData(JSON.parse(data[i][0]), {onEachFeature: onEachFeature, style : style});
        }
    });
			
			
	</script>

</body>
</html>
